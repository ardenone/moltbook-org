---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: moltbook

# Temporary kustomization that excludes namespace creation
# This is a workaround for lack of namespace creation permissions
# Requires namespace to be pre-created by cluster admin:
#   kubectl create namespace moltbook

resources:
  # - namespace/moltbook-namespace.yml  # EXCLUDED - requires cluster-scoped permissions
  - namespace/moltbook-rbac.yml
  - secrets/moltbook-api-sealedsecret.yml
  - secrets/moltbook-postgres-superuser-sealedsecret.yml
  - secrets/moltbook-db-credentials-sealedsecret.yml
  - database/cluster.yml
  - database/service.yml
  - database/schema-configmap.yml
  - database/schema-init-deployment.yml
  - redis/configmap.yml
  - redis/deployment.yml
  - redis/service.yml
  - api/configmap.yml
  - api/deployment.yml
  - api/service.yml
  - api/ingressroute.yml
  - frontend/configmap.yml
  - frontend/deployment.yml
  - frontend/service.yml
  - frontend/ingressroute.yml

images:
  - name: ghcr.io/moltbook/api
    newName: ghcr.io/ardenone/moltbook-api
    newTag: latest
  - name: ghcr.io/moltbook/frontend
    newName: ghcr.io/ardenone/moltbook-frontend
    newTag: latest

labels:
  - pairs:
      app.kubernetes.io/name: moltbook
      app.kubernetes.io/component: platform
      app.kubernetes.io/part-of: moltbook
      app.kubernetes.io/managed-by: kubectl
