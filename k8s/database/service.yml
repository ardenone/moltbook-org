---
# Service for Moltbook PostgreSQL database
# Note: CloudNativePG automatically creates the following services:
# - moltbook-postgres-rw (read-write, connects to primary instance)
# - moltbook-postgres-ro (read-only, connects to any replica)
# - moltbook-postgres-r (read-only, load balanced across replicas)
#
# This explicit Service manifest is provided for documentation purposes
# and to ensure the service is explicitly defined for Kubernetes discovery.
apiVersion: v1
kind: Service
metadata:
  name: moltbook-postgres
  namespace: moltbook
  labels:
    app: moltbook-postgres
    app.kubernetes.io/name: postgres
    app.kubernetes.io/component: database
spec:
  type: ClusterIP
  ports:
  - port: 5432
    targetPort: 5432
    protocol: TCP
    name: postgres
  selector:
    # CloudNativePG creates pods with the following label
    cnpg.io/podRole: instance
    # This selector matches the CNPG cluster name
    cnpg.io/cluster: moltbook-postgres
